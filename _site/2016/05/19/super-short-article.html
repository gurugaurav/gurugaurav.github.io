<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--- layout: post title: "Some articles are just so short that we have to make the footer stick" tags: ml xyz ---
</code></pre></div></div>

<p>A simple linear regression model can be used to build a relation between an explanatory variable and one target variable. it tries to generate the system of line that can fit in the data with minimum loss. It tries to calculate coefficient and intercept of…”&gt;<meta name="generator" content="Publii Open-Source CMS for Static Site" /><link rel="canonical" href="https://gurugaurav.github.io/basic-of-linear-regression.html" /><link rel="alternate" type="application/atom+xml" href="https://gurugaurav.github.io/feed.xml" /><link rel="alternate" type="application/json" href="https://gurugaurav.github.io/feed.json" /><meta property="og:title" content="Basic of Linear regression" /><meta property="og:site_name" content="Guru Prasad Singh" /><meta property="og:description" content="A simple linear regression model can be used to build a relation between an explanatory variable and one target variable. it tries to generate the system of line that can fit in the data with minimum loss. It tries to calculate coefficient and intercept of&hellip;" /><meta property="og:url" content="https://gurugaurav.github.io/basic-of-linear-regression.html" /><meta property="og:type" content="article" /><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://gurugaurav.github.io/assets/css/style.css?v=f649c45e53d1fe0450f686bddcde27e4" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://gurugaurav.github.io/basic-of-linear-regression.html"},"headline":"Basic of Linear regression","datePublished":"2020-09-25T22:38","dateModified":"2020-09-25T23:33","description":"A simple linear regression model can be used to build a relation between an explanatory variable and one target variable. it tries to generate the system of line that can fit in the data with minimum loss. It tries to calculate coefficient and intercept of&hellip;","author":{"@type":"Person","name":"Guru Prasad Singh"},"publisher":{"@type":"Organization","name":"Guru Prasad Singh"}}</script>&lt;/head&gt;&lt;body&gt;&lt;div class="site-container"&gt;&lt;header class="top" id="js-header"&gt;<a class="logo" href="https://gurugaurav.github.io/">Guru Prasad Singh</a>&lt;nav class="navbar js-navbar"&gt;<button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button>&lt;ul class="navbar__menu"&gt;&lt;li&gt;<a href="https://gurugaurav.github.io/" title="Home" target="_self">Home</a>&lt;/li&gt;&lt;li&gt;<a href="https://gurugaurav.github.io/contact" target="_self">Contact</a>&lt;/li&gt;&lt;/ul&gt;&lt;/nav&gt;&lt;/header&gt;&lt;main&gt;&lt;article class="post"&gt;&lt;div class="hero"&gt;<figure class="hero__image hero__image--overlay"><img src="https://gurugaurav.github.io/media/website/shutterstock_668209624-1.jpg" srcset="https://gurugaurav.github.io/media/website/responsive/shutterstock_668209624-1-xs.jpg 300w, https://gurugaurav.github.io/media/website/responsive/shutterstock_668209624-1-sm.jpg 480w, https://gurugaurav.github.io/media/website/responsive/shutterstock_668209624-1-md.jpg 768w, https://gurugaurav.github.io/media/website/responsive/shutterstock_668209624-1-lg.jpg 1024w, https://gurugaurav.github.io/media/website/responsive/shutterstock_668209624-1-xl.jpg 1360w, https://gurugaurav.github.io/media/website/responsive/shutterstock_668209624-1-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" alt="" /></figure>&lt;header class="hero__content"&gt;&lt;div class="wrapper"&gt;&lt;div class="post__meta"&gt;<time datetime="2020-09-25T22:38">September 25, 2020</time>&lt;/div&gt;&lt;h1&gt;Basic of Linear regression&lt;/h1&gt;&lt;div class="post__meta post__meta--author"&gt;<img src="https://www.gravatar.com/avatar/e3b511226c458f1fc1ab1d5107c966d6?s&#x3D;240" loading="eager" alt="Guru Prasad Singh" class="post__author-thumb" /> <a href="https://gurugaurav.github.io/authors/guru-prasad/" class="feed__author invert">Guru Prasad Singh</a>&lt;/div&gt;&lt;/div&gt;&lt;/header&gt;&lt;/div&gt;&lt;div class="wrapper post__entry"&gt;&lt;p&gt;A simple linear regression model can be used to build a relation between an explanatory variable and one target variable.  it tries to generate the system of line that can fit in the data with minimum loss. It tries to calculate coefficient and intercept of the line.&lt;/p&gt;&lt;p class="align-left"&gt;Lets consider you want to predict the price of a pizza. So while predicting the price the variable that comes into your mind is the size of pizza. For now don’t consider other features like thickness of pizza and the type of pizza etc.  Lets build a relation between size of pizza and the price of pizza using this dummy data.&lt;/p&gt;&lt;table class="dataframe align-center" style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal); height: 276px; width: 211px;" border="1" width="321"&gt;&lt;thead&gt;&lt;tr style="height: 47px;"&gt;&lt;th style="width: 122.5px; height: 47px;"&gt;Diameter&lt;/th&gt;&lt;td style="width: 87.5px; height: 47px;"&gt;Price&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr style="height: 47px;"&gt;&lt;td style="width: 122.5px; height: 47px;"&gt;6&lt;/td&gt;&lt;td style="width: 87.5px; height: 47px;"&gt;5.0&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 47px;"&gt;&lt;td style="width: 122.5px; height: 47px;"&gt;8&lt;/td&gt;&lt;td style="width: 87.5px; height: 47px;"&gt;10.0&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 47px;"&gt;&lt;td style="width: 122.5px; height: 47px;"&gt;10&lt;/td&gt;&lt;td style="width: 87.5px; height: 47px;"&gt;13.0&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 47px;"&gt;&lt;td style="width: 122.5px; height: 47px;"&gt;14&lt;/td&gt;&lt;td style="width: 87.5px; height: 47px;"&gt;17.5&lt;/td&gt;&lt;/tr&gt;&lt;tr style="height: 47px;"&gt;&lt;td style="width: 122.5px; height: 47px;"&gt;18&lt;/td&gt;&lt;td style="width: 87.5px; height: 47px;"&gt;18.0&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;Lets visualize the data using using matplot.&lt;/p&gt;&lt;p&gt;<code>import matplotlib.pyplot as plt</code><br /><code>import seaborn as sns</code><br /><code>sns.set()</code>&lt;/p&gt;&lt;p&gt;<code>plt.figure()</code><br /><code>plt.title('Pizza price plotted against diameter')</code><br /><code>plt.xlabel('Diameter in inches')</code><br /><code>plt.ylabel('Price in dollars')</code><br /><code>plt.plot(X, y, 'k.')</code><br /><code>plt.axis([0, 25, 0, 25])</code><br /><code>plt.grid(True)</code><br /><code>plt.show()</code>&lt;/p&gt;<figure class="post__image align-center"><img loading="lazy" src="https://gurugaurav.github.io/media/posts/3/download.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://gurugaurav.github.io/media/posts/3/responsive/download-xs.png 300w, https://gurugaurav.github.io/media/posts/3/responsive/download-sm.png 480w, https://gurugaurav.github.io/media/posts/3/responsive/download-md.png 768w, https://gurugaurav.github.io/media/posts/3/responsive/download-lg.png 1024w, https://gurugaurav.github.io/media/posts/3/responsive/download-xl.png 1360w, https://gurugaurav.github.io/media/posts/3/responsive/download-2xl.png 1600w" alt="" width="391" height="279" /></figure>&lt;p&gt;We can see from the graph of the training data that there is a positive relationship<br />between the diameter of a pizza and its price, which should be corroborated by our<br />own pizza-eating experience. As the diameter of a pizza increases, its price generally<br />increases too. The following pizza-price predictor program models this relationship<br />using linear regression&lt;/p&gt;&lt;p&gt;<code>from sklearn.linear_model import LinearRegression</code>&lt;/p&gt;&lt;p&gt;<code># Create and fit the model</code><br /><code>model = LinearRegression()</code><br /><code>model.fit(X, y)</code>&lt;/p&gt;&lt;div class="cell code_cell rendered selected" tabindex="2"&gt;&lt;div class="output_wrapper"&gt;&lt;div class="output"&gt;&lt;div class="output_area"&gt;&lt;div class="output_subarea output_text output_result"&gt;&lt;pre&gt;LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt; &lt;/p&gt;&lt;p&gt;<code>x_test = [[3],[20]]</code><br /><code>pred = model.predict(x_test)</code><br /><code>print('prediction:\n{}'.format(pred))</code>&lt;/p&gt;&lt;pre&gt;prediction:
[[ 4.05818966]
 [21.97413793]]&lt;/pre&gt;&lt;p&gt;<code>plt.figure()</code><br /><code>plt.title('Pizza price plotted against diameter')</code><br /><code>plt.xlabel('Diameter in inches')</code><br /><code>plt.ylabel('Price in dollars')</code><br /><code>plt.scatter(X, y)</code><br /><code>plt.plot(x_test, pred)</code><br /><code>plt.axis([0, 25, 0, 25])</code><br /><code>plt.grid(True)</code><br /><code>plt.show()</code>&lt;/p&gt;&lt;p&gt; &lt;/p&gt;<figure class="post__image"><img loading="lazy" src="https://gurugaurav.github.io/media/posts/3/download-3.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://gurugaurav.github.io/media/posts/3/responsive/download-3-xs.png 300w, https://gurugaurav.github.io/media/posts/3/responsive/download-3-sm.png 480w, https://gurugaurav.github.io/media/posts/3/responsive/download-3-md.png 768w, https://gurugaurav.github.io/media/posts/3/responsive/download-3-lg.png 1024w, https://gurugaurav.github.io/media/posts/3/responsive/download-3-xl.png 1360w, https://gurugaurav.github.io/media/posts/3/responsive/download-3-2xl.png 1600w" alt="" width="391" height="279" /></figure>&lt;p&gt;The fit method of LinearRegression learns the parameters of the following model<br />for simple linear regression:<br />                                                        y = a + bx&lt;/p&gt;&lt;hr&gt;&lt;h4&gt; &lt;/h4&gt;&lt;h4&gt;<span style="text-decoration: underline;"><strong>Ordinary Least Square</strong></span>&lt;/h4&gt;&lt;p&gt;From the above equation we can see that to calulate the linear regression we need to calculate the value of two variable a and b.&lt;/p&gt;&lt;p&gt;This can be solve by calculating the <strong>variance </strong>and <strong>co-variance</strong> of the x and y.&lt;/p&gt;<figure class="post__image"><img loading="lazy" src="https://gurugaurav.github.io/media/posts/3/var.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://gurugaurav.github.io/media/posts/3/responsive/var-xs.png 300w, https://gurugaurav.github.io/media/posts/3/responsive/var-sm.png 480w, https://gurugaurav.github.io/media/posts/3/responsive/var-md.png 768w, https://gurugaurav.github.io/media/posts/3/responsive/var-lg.png 1024w, https://gurugaurav.github.io/media/posts/3/responsive/var-xl.png 1360w, https://gurugaurav.github.io/media/posts/3/responsive/var-2xl.png 1600w" alt="" width="344" height="138" /></figure><figure class="post__image"><img loading="lazy" src="https://gurugaurav.github.io/media/posts/3/cov-2.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://gurugaurav.github.io/media/posts/3/responsive/cov-2-xs.png 300w, https://gurugaurav.github.io/media/posts/3/responsive/cov-2-sm.png 480w, https://gurugaurav.github.io/media/posts/3/responsive/cov-2-md.png 768w, https://gurugaurav.github.io/media/posts/3/responsive/cov-2-lg.png 1024w, https://gurugaurav.github.io/media/posts/3/responsive/cov-2-xl.png 1360w, https://gurugaurav.github.io/media/posts/3/responsive/cov-2-2xl.png 1600w" alt="" width="367" height="116" /></figure>&lt;p&gt;a and b can be calculated using :&lt;/p&gt;&lt;p&gt;cov(x,y) / var(x,y)&lt;/p&gt;&lt;p&gt; &lt;/p&gt;&lt;p&gt;Using above data:&lt;/p&gt;&lt;p&gt;<code>xbar = (6 + 8 + 10 + 14 + 18) / 5</code><br /><code>variance = ((6 - xbar)**2 + (8 - xbar)**2 + (10 - xbar)**2 + (14 -xbar)**2 + (18 - xbar)**2) / 4</code><br /><code>print(variance)</code>&lt;/p&gt;&lt;pre&gt;23.2&lt;/pre&gt;&lt;p&gt;<code>import numpy as np</code><br /><code>np.var([6, 8, 10, 14, 18], ddof=1)</code>&lt;/p&gt;&lt;p&gt;<code>xbar = (6 + 8 + 10 + 14 + 18) / 5</code><br /><code>ybar = (7 + 9 + 13 + 17.5 + 18) / 5</code><br /><code>cov = ((6 - xbar) * (7 - ybar) + (8 - xbar) * (9 - ybar) + (10 -xbar) * (13 - ybar) +</code><br /><code>       (14 - xbar) * (17.5 - ybar) + (18 - xbar) * (18 - ybar)) /4</code><br /><code>print(cov)</code>&lt;/p&gt;&lt;pre&gt;22.65&lt;/pre&gt;&lt;p&gt;<code>beta = 22.65 /23.2</code><br /><code>print(beta)</code>&lt;/p&gt;&lt;pre&gt;0.9762931034482758&lt;/pre&gt;&lt;p&gt;<code>alpha = ybar - beta*xbar</code><br /><code>print(alpha)</code>&lt;/p&gt;&lt;pre&gt;1.9655172413793114&lt;/pre&gt;&lt;/div&gt;</p>
