<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Multiple Linear Regression | Guru Prasad Singh</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Multiple Linear Regression" />
<meta name="author" content="Guru Prasad Singh" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the previous example, we have trained and evaluated a model to predict the price of a pizza. While you are eager to demonstrate the pizza-price predictor to your friends and co-workers, you are concerned by the model’s imperfect r-squared score and the embarrassment its predictions could cause you." />
<meta property="og:description" content="In the previous example, we have trained and evaluated a model to predict the price of a pizza. While you are eager to demonstrate the pizza-price predictor to your friends and co-workers, you are concerned by the model’s imperfect r-squared score and the embarrassment its predictions could cause you." />
<link rel="canonical" href="http://localhost:4000/2020/09/27/multiple-linear-regression.html" />
<meta property="og:url" content="http://localhost:4000/2020/09/27/multiple-linear-regression.html" />
<meta property="og:site_name" content="Guru Prasad Singh" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-27T00:00:00+05:30" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/09/27/multiple-linear-regression.html"},"author":{"@type":"Person","name":"Guru Prasad Singh"},"url":"http://localhost:4000/2020/09/27/multiple-linear-regression.html","description":"In the previous example, we have trained and evaluated a model to predict the price of a pizza. While you are eager to demonstrate the pizza-price predictor to your friends and co-workers, you are concerned by the model’s imperfect r-squared score and the embarrassment its predictions could cause you.","@type":"BlogPosting","headline":"Multiple Linear Regression","dateModified":"2020-09-27T00:00:00+05:30","datePublished":"2020-09-27T00:00:00+05:30","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="assets/css/syntax.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Guru Prasad Singh" />
</head>
<body><header class="site-header">

  <div class="nav-wrapper"><a class="site-title" rel="author" href="/">Guru Prasad Singh</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Multiple Linear Regression</h1>
    <p class="post-meta"><time class="dt-published" datetime="2020-09-27T00:00:00+05:30" itemprop="datePublished">
        Sep 27, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In the previous example, we have trained and evaluated a model to predict the price of a pizza. While you are eager to demonstrate the pizza-price predictor to your friends and co-workers, you are concerned by the model’s imperfect r-squared score and the embarrassment its predictions could cause you.</p>

<p>How can we improve the model?
Recalling your personal pizza-eating experience, you might have some intuitions
about the other attributes of a pizza that are related to its price. For instance, the
price often depends on the number of toppings on the pizza. Fortunately, your
pizza journal describes toppings in detail; let’s add the number of toppings to our
training data as a second explanatory variable. We cannot proceed with simple linearregression, but we can use a generalization of simple linear regression that can use multiple explanatory variables called multiple linear regression. Formally, multiple linear regression is the following model:</p>

<script type="math/tex; mode=display">y =  \alpha + \beta_1 x_1 +  \beta_2x _2 +  \beta_3x_3 ......</script>

<p>this edit makes no sense. change to “Where simple linear regression uses a single
explanatory variable with a single coefficient, multiple linear regression uses a
coefficient for each of an arbitrary number of explanatory variables.</p>

<script type="math/tex; mode=display">y = X \beta</script>

<p>For simple linear regression, this is equivalent to the following:</p>

<script type="math/tex; mode=display">\begin{bmatrix}y_{1}\\y_{2}\\...\\y_{4}\end{bmatrix} =  \begin{bmatrix} \alpha + \beta X_{1}\\\alpha +\beta X_{2}\\...\\\alpha + \beta X_{3}\end{bmatrix} =  \begin{bmatrix}1 + X_{1}\\1 + X_{1}\\...\\1 + X_{1}\end{bmatrix} × \begin{bmatrix} \alpha \\ \beta \end{bmatrix}</script>

<p>Y is a column vector of the values of the response variables for the training examples.
<script type="math/tex">\beta</script> is a column vector of the values of the model’s parameters. X, called the design
matrix, is an m× n dimensional matrix of the values of the explanatory variables for
the training examples. m is the number of training examples and n is the number of
explanatory variables.Let’s update our pizza training data to include the number of
toppings with the following values:</p>

<table>
  <thead>
    <tr>
      <th>Training Example</th>
      <th>Diameter</th>
      <th>Number of toppings</th>
      <th>Price (in dollars)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2</td>
      <td>8</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>10</td>
      <td>0</td>
      <td>13</td>
    </tr>
    <tr>
      <td>4</td>
      <td>14</td>
      <td>2</td>
      <td>17.5</td>
    </tr>
    <tr>
      <td>5</td>
      <td>18</td>
      <td>0</td>
      <td>18</td>
    </tr>
  </tbody>
</table>

<p>We must also update our test data to include the second explanatory variable,
as follows:</p>

<table>
  <thead>
    <tr>
      <th>Training Example</th>
      <th>Diameter</th>
      <th>Number of toppings</th>
      <th>Price (in dollars)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>11</td>
    </tr>
    <tr>
      <td>2</td>
      <td>9</td>
      <td>0</td>
      <td>8.5</td>
    </tr>
    <tr>
      <td>3</td>
      <td>11</td>
      <td>2</td>
      <td>15</td>
    </tr>
    <tr>
      <td>4</td>
      <td>16</td>
      <td>2</td>
      <td>18</td>
    </tr>
    <tr>
      <td>5</td>
      <td>12</td>
      <td>0</td>
      <td>11</td>
    </tr>
  </tbody>
</table>

<p>Our learning algorithm must estimate the values of three parameters: the coefficients for the two features and the intercept term. While one might be tempted to solve <script type="math/tex">\beta</script>  by
dividing each side of the equation by X , division by a matrix is impossible. Just as
dividing a number by an integer is equivalent to multiplying by the inverse of the
same integer, we can multiply <script type="math/tex">\beta</script>  by the inverse of X to avoid matrix division. Matrix
inversion is denoted with a superscript -1. Only square matrices can be inverted. X
is not likely to be a square; the number of training instances will have to be equal to
the number of features for it to be so. We will multiply X by its transpose to yield a
square matrix that can be inverted. Denoted with a superscript T , the transpose of a
matrix is formed by turning the rows of the matrix into columns and vice versa,
as follows:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{bmatrix}1&2&3\\4&5&6\end{bmatrix}^T =  \begin{bmatrix}1&4\\2&5\\3&6\end{bmatrix} %]]></script>

<p>We know the values of Y and X from our training data. We must find the values
of <script type="math/tex">\beta</script> , which minimize the cost function. We can solve <script type="math/tex">\beta</script> as follows:</p>

<script type="math/tex; mode=display">\beta = ( X^T X)^1 X^TY</script>

<p>Lets solve it using python:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">from</span> <span class="n">sklearn</span><span class="p">.</span><span class="n">linear_model</span> <span class="n">import</span> <span class="n">LinearRegression</span>
<span class="n">X</span> <span class="p">=</span> <span class="p">[[</span><span class="m">6</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">[</span><span class="m">8</span><span class="p">,</span> <span class="m">1</span><span class="p">],</span> <span class="p">[</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">],</span> <span class="p">[</span><span class="m">14</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">[</span><span class="m">18</span><span class="p">,</span> <span class="m">0</span><span class="p">]]</span>
<span class="n">y</span> <span class="p">=</span> <span class="p">[[</span><span class="m">7</span><span class="p">],</span> <span class="p">[</span><span class="m">9</span><span class="p">],</span> <span class="p">[</span><span class="m">13</span><span class="p">],</span> <span class="p">[</span><span class="m">17.5</span><span class="p">],</span> <span class="p">[</span><span class="m">18</span><span class="p">]]</span>
<span class="k">model</span> <span class="p">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="k">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">X_test</span> <span class="p">=</span> <span class="p">[[</span><span class="m">8</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">[</span><span class="m">9</span><span class="p">,</span> <span class="m">0</span><span class="p">],</span> <span class="p">[</span><span class="m">11</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">[</span><span class="m">16</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">[</span><span class="m">12</span><span class="p">,</span> <span class="m">0</span><span class="p">]]</span>
<span class="n">y_test</span> <span class="p">=</span> <span class="p">[[</span><span class="m">11</span><span class="p">],</span> <span class="p">[</span><span class="m">8.5</span><span class="p">],</span> <span class="p">[</span><span class="m">15</span><span class="p">],</span> <span class="p">[</span><span class="m">18</span><span class="p">],</span> <span class="p">[</span><span class="m">11</span><span class="p">]]</span>
<span class="n">predictions</span> <span class="p">=</span> <span class="k">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prediction</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
  <span class="n">print</span><span class="p">(</span><span class="n">Predicted</span><span class="p">:</span> <span class="p">%</span><span class="n">s</span><span class="p">,</span> <span class="n">Target</span><span class="p">:</span> <span class="p">%</span><span class="n">s</span><span class="s1">' % (prediction, y_test[i]))
print('</span><span class="n">R</span><span class="p">-</span><span class="n">squared</span><span class="p">:</span> <span class="p">%</span><span class="m">.2f</span><span class="s1">' % model.score(X_test, y_test))
</span></code></pre></div></div>

<blockquote>
  <p>Predicted: [ 10.0625], Target: [11]</p>

  <p>Predicted: [ 10.28125], Target: [8.5]</p>

  <p>Predicted: [ 13.09375], Target: [15]</p>

  <p>Predicted: [ 18.14583333], Target: [18]</p>

  <p>Predicted: [ 13.3125], Target: [11]</p>

  <p>R-squared: 0.77</p>
</blockquote>

  </div><a class="u-url" href="/2020/09/27/multiple-linear-regression.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Guru Prasad Singh</li>
          <li><a class="u-email" href="mailto:g.gaurav541@gmail.com">g.gaurav541@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Guru prasad Singh presonal blog for Machine Learning and Deep Leraning
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/guruguarav" title="guruguarav"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/g_p_singh" title="g_p_singh"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
